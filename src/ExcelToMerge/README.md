# Excel数据处理转换工具

## 项目概述

本项目是一个用于医院HIS系统数据处理的工具，可以导入多个Excel/CSV数据文件，进行合并、清洗、转换处理，并按标准格式导出。

## 技术选型

- 开发环境：.NET Framework 4.5.1
- 开发语言：C#
- 界面框架：WinForms
- 数据库：SQLite
- Excel/CSV操作：EPPlus、CsvHelper
- ORM：Dapper

## 项目结构

```
ExcelToMerge/
├── Models/           # 数据模型
├── Services/         # 业务服务
├── Utils/            # 工具类
└── UI/               # 用户界面
```

## 功能模块

### 1. Excel导入功能

- 支持导入Excel或CSV数据
- 显示导入进度条
- 将数据存储到本地SQLite数据库
- 数据库表名与Excel文件名一致
- 处理表名冲突（追加/重建）

### 2. 转换(SQL)功能

- 配置1-N个转换作业
- 每个转换作业可配置SQL转换脚本和导出格式
- 查看本地SQLite数据库表和字段

### 3. 调度功能

- 配置多个转换任务
- 一键执行所有配置的任务并导出数据

## 数据库设计

### 系统表

1. ImportHistory：导入历史记录
2. ConvertTask：转换任务配置
3. ScheduleConfig：调度配置
4. ScheduleDetail：调度明细
5. ExecutionLog：执行日志

### 动态表

- 根据导入的Excel/CSV文件动态创建表

## 性能优化

针对几十万级数据量的优化措施：

1. 批量插入
2. 分页查询
3. 索引优化
4. 查询优化
5. 内存管理
6. 并行处理

## 开发状态

### 已完成任务/功能

1. 项目基础架构搭建
2. 数据库设计与初始化
3. Excel/CSV导入功能
4. 数据转换功能
5. 调度功能

### 待完成任务/功能

1. 性能优化
2. 错误处理完善
3. 用户界面美化
4. 单元测试
5. 安装程序制作

## 使用说明

1. 启动程序
2. 导入Excel/CSV文件
3. 配置转换任务
4. 设置调度任务
5. 执行调度任务导出数据 